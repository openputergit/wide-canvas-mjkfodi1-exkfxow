<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BrickCoin - Telegram Mini App</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --tg-theme-bg-color: #0f172a;
            --tg-theme-text-color: #ffffff;
            --tg-theme-hint-color: #94a3b8;
            --tg-theme-link-color: #38bdf8;
            --tg-theme-button-color: #3b82f6;
            --tg-theme-button-text-color: #ffffff;
            --accent-gradient-start: #3b82f6;
            --accent-gradient-end: #06b6d4;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            -webkit-tap-highlight-color: transparent;
            overflow: hidden; /* App-like feel */
            touch-action: manipulation;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Coin Animation */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .animate-float {
            animation: float 4s ease-in-out infinite;
        }

        /* Tap Animation */
        @keyframes tap-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }
        .tap-active {
            animation: tap-pulse 0.1s ease-in-out;
        }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Floating +1 Text */
        .floating-text {
            position: absolute;
            color: #ffffff;
            font-weight: bold;
            font-size: 24px;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            z-index: 50;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-100px) scale(1.5); }
        }

        .nav-item.active i {
            color: #38bdf8;
        }
        .nav-item.active span {
            color: #38bdf8;
        }
        
        .loader {
            border: 3px solid rgba(255,255,255,0.1);
            border-left-color: #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="h-screen w-full flex flex-col relative text-white">

    <!-- Background Pattern (Subtle Brick Textures inspired by image) -->
    <div class="absolute inset-0 z-0 opacity-10 pointer-events-none" 
         style="background-image: radial-gradient(#38bdf8 1px, transparent 1px); background-size: 24px 24px;">
    </div>
    
    <!-- Top Header & Balance -->
    <header class="flex-none p-4 pb-2 z-10 w-full glass-panel border-b-0 rounded-b-2xl mb-2">
        <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-blue-500 to-cyan-400 flex items-center justify-center text-xs font-bold">
                    USER
                </div>
                <span id="username-display" class="font-medium text-sm text-slate-300">PlayerOne</span>
            </div>
            <div class="px-3 py-1 bg-slate-800 rounded-full border border-slate-700 text-xs font-medium text-slate-400">
                <i class="bi bi-shield-lock-fill mr-1"></i> Connected
            </div>
        </div>

        <div class="text-center py-2">
            <p class="text-slate-400 text-xs uppercase tracking-widest font-semibold mb-1">Total Balance</p>
            <div class="flex items-center justify-center gap-2">
                <i class="bi bi-bricks text-4xl text-blue-400 drop-shadow-lg"></i>
                <h1 id="balance-display" class="text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-200">0</h1>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="main-container" class="flex-1 overflow-y-auto w-full z-10 p-4 pb-24 no-scrollbar relative">
        
        <!-- HOME VIEW -->
        <div id="home-view" class="view-section flex flex-col items-center justify-center h-full min-h-[400px]">
            <div class="relative w-64 h-64 flex items-center justify-center mb-8 cursor-pointer active:scale-95 transition-transform" id="clicker-btn">
                <!-- Outer glow -->
                <div class="absolute inset-0 bg-blue-500 rounded-full blur-3xl opacity-20"></div>
                <!-- Main Tapper -->
                <div class="w-60 h-60 rounded-full bg-gradient-to-b from-slate-700 to-slate-900 border-4 border-slate-600 shadow-2xl flex items-center justify-center relative overflow-hidden group">
                    <img src="https://images.unsplash.com/photo-1590059390230-671c66763809?q=80&w=260&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-40 mix-blend-overlay" alt="Texture">
                    <i class="bi bi-gem text-8xl text-blue-400 drop-shadow-[0_0_15px_rgba(59,130,246,0.5)] group-hover:scale-110 transition-transform duration-200"></i>
                </div>
            </div>
            
            <div class="flex flex-col items-center text-slate-400 space-y-2">
                <p class="text-sm">Tap to mine tokens </p>
                <div class="flex items-center gap-2 bg-slate-800/50 px-4 py-2 rounded-lg border border-slate-700/50">
                    <i class="bi bi-lightning-charge-fill text-yellow-400"></i>
                    <span id="energy-display" class="text-white font-mono">1000/1000</span>
                </div>
            </div>
            
            <!-- Quick Task Preview -->
            <div class="w-full mt-8">
                <div class="flex justify-between items-center mb-2 px-1">
                    <h3 class="text-sm font-bold uppercase text-slate-400">Admin Tasks</h3>
                    <button onclick="switchTab('tasks')" class="text-xs text-blue-400 hover:text-blue-300">View All</button>
                </div>
                <!-- A single featured task -->
                <div id="featured-task-container"></div>
            </div>
        </div>

        <!-- TASKS VIEW -->
        <div id="tasks-view" class="view-section hidden">
            <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-6 rounded-2xl mb-6 text-center shadow-lg relative overflow-hidden">
                <i class="bi bi-list-check absolute -right-4 -bottom-4 text-9xl text-white opacity-10"></i>
                <h2 class="text-2xl font-bold mb-1">Earn Tokens</h2>
                <p class="text-blue-100 text-sm">Complete tasks assigned by admin to earn massive rewards.</p>
            </div>

            <div class="space-y-4" id="tasks-list">
                <!-- Tasks injected by JS -->
            </div>
        </div>

        <!-- WALLET/LEADERBOARD VIEW -->
        <div id="wallet-view" class="view-section hidden">
            <div class="glass-panel p-6 rounded-2xl mb-6 text-center">
                <p class="text-slate-400 text-sm mb-1">Available to Withdraw</p>
                <h2 class="text-4xl font-bold text-white mb-4 flex items-center justify-center gap-2">
                    <i class="bi bi-bricks text-blue-400 text-2xl"></i> <span id="wallet-balance">0</span>
                </h2>
                <button class="w-full py-3 bg-slate-700 text-slate-400 rounded-xl cursor-not-allowed text-sm font-medium" disabled>
                    Withdrawals Opening Soon
                </button>
            </div>

            <h3 class="font-bold text-lg mb-4 pl-1">Recent Activity</h3>
            <div id="activity-log" class="space-y-3">
                <!-- Activity Log -->
                <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-xl border border-slate-700/50">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center">
                            <i class="bi bi-gift-fill"></i>
                        </div>
                        <div>
                            <p class="font-medium text-sm">Welcome Bonus</p>
                            <p class="text-xs text-slate-500">Just now</p>
                        </div>
                    </div>
                    <span class="text-green-400 font-bold">+100</span>
                </div>
            </div>
        </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="flex-none bg-slate-900 border-t border-slate-800 px-6 py-3 pb-6 safe-area-bottom z-50">
        <div class="flex justify-around items-center">
            <button onclick="switchTab('home')" class="nav-item active flex flex-col items-center gap-1 w-16 group transition-colors" data-target="home">
                <i class="bi bi-house-door-fill text-xl group-hover:scale-110 transition-transform"></i>
                <span class="text-[10px] font-medium">Home</span>
            </button>
            <button onclick="switchTab('tasks')" class="nav-item flex flex-col items-center gap-1 w-16 group text-slate-500 transition-colors" data-target="tasks">
                <div class="relative">
                    <i class="bi bi-clipboard-check-fill text-xl group-hover:scale-110 transition-transform"></i>
                    <span id="task-badge" class="absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full hidden"></span>
                </div>
                <span class="text-[10px] font-medium">Tasks</span>
            </button>
            <button onclick="switchTab('wallet')" class="nav-item flex flex-col items-center gap-1 w-16 group text-slate-500 transition-colors" data-target="wallet">
                <i class="bi bi-wallet-fill text-xl group-hover:scale-110 transition-transform"></i>
                <span class="text-[10px] font-medium">Wallet</span>
            </button>
        </div>
    </nav>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-slate-800 border border-slate-700 text-white px-4 py-3 rounded-xl shadow-2xl flex items-center gap-3 transition-all duration-300 opacity-0 pointer-events-none translate-y-[-20px] z-50 w-[90%] max-w-sm">
        <i class="bi bi-check-circle-fill text-green-500 text-xl"></i>
        <div>
            <h4 class="font-bold text-sm" id="toast-title">Success</h4>
            <p class="text-xs text-slate-400" id="toast-message">Task completed!</p>
        </div>
    </div>

    <!-- Modal for Task Details -->
    <div id="task-modal" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none opacity-0 transition-opacity duration-300">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" id="modal-backdrop"></div>
        <div class="bg-slate-900 w-full sm:w-[400px] rounded-t-2xl sm:rounded-2xl p-6 transform translate-y-full sm:translate-y-10 transition-transform duration-300 pointer-events-auto border-t border-slate-700 sm:border border-slate-700 shadow-2xl relative">
            <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-12 h-1.5 bg-slate-600 rounded-full sm:hidden"></div>
            
            <div class="text-center mb-6">
                <div class="w-16 h-16 rounded-2xl bg-slate-800 mx-auto mb-4 flex items-center justify-center text-3xl" id="modal-icon">
                    <i class="bi bi-telegram text-blue-400"></i>
                </div>
                <h3 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400" id="modal-title">Join Channel</h3>
                <p class="text-slate-400 text-sm mt-2 px-4" id="modal-desc">Join our official Telegram channel to stay updated with the latest news and drops.</p>
                <div class="mt-4 inline-flex items-center gap-1 bg-blue-500/10 text-blue-400 px-3 py-1 rounded-full text-sm font-bold border border-blue-500/20">
                    <i class="bi bi-bricks"></i> +<span id="modal-reward">500</span>
                </div>
            </div>

            <div class="space-y-3">
                <a href="#" target="_blank" id="modal-action-btn" class="w-full block text-center py-3.5 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-medium transition-colors border border-slate-700">
                    Step 1: Go to Task
                </a>
                <button id="modal-check-btn" class="w-full py-3.5 bg-gradient-to-r from-blue-600 to-cyan-500 text-white rounded-xl font-bold shadow-lg shadow-blue-500/20 active:scale-[0.98] transition-all disabled:opacity-50 disabled:grayscale">
                    Step 2: Check & Claim
                </button>
            </div>

            <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white p-2">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
    </div>

    <script>
        // --- State Management ---
        const STATE = {
            balance: 0,
            energy: 1000,
            tasks: [
                { id: 1, title: "Join Global Chat", desc: "Join our vibrant community chat on Telegram.", reward: 500, status: "pending", icon: "bi-telegram", link: "#", type: "telegram" },
                { id: 2, title: "Follow on X", desc: "Follow our official X handle for updates.", reward: 300, status: "pending", icon: "bi-twitter-x", link: "#", type: "twitter" },
                { id: 3, title: "Watch Intro Video", desc: "Watch our project introduction on YouTube.", reward: 250, status: "pending", icon: "bi-youtube", link: "#", type: "youtube" },
                { id: 4, title: "Invite a Friend", desc: "Share your referral link with a friend.", reward: 1000, status: "pending", icon: "bi-person-plus-fill", link: "#", type: "invite" },
                { id: 5, title: "Daily Check-in", desc: "Log in and claim your daily reward.", reward: 100, status: "pending", icon: "bi-calendar-check", link: "#", type: "daily" }
            ],
            history: []
        };

        // Load from LocalStorage
        function loadState() {
            const saved = localStorage.getItem('brickCoinState');
            if (saved) {
                const parsed = JSON.parse(saved);
                STATE.balance = parsed.balance || 0;
                // Merge loaded tasks with initial tasks to ensure updates to task structure don't break
                STATE.tasks = STATE.tasks.map(initTask => {
                    const savedTask = parsed.tasks.find(t => t.id === initTask.id);
                    return savedTask ? { ...initTask, status: savedTask.status } : initTask;
                });
                STATE.history = parsed.history || [];
            }
            updateUI();
        }

        function saveState() {
            localStorage.setItem('brickCoinState', JSON.stringify(STATE));
        }

        // --- UI Updates ---
        function updateUI() {
            // Update Balance
            document.getElementById('balance-display').textContent = STATE.balance.toLocaleString();
            document.getElementById('wallet-balance').textContent = STATE.balance.toLocaleString();
            
            // Update Activity Log
            const logContainer = document.getElementById('activity-log');
            logContainer.innerHTML = '';
            if (STATE.history.length === 0) {
                logContainer.innerHTML = '<p class="text-center text-slate-500 text-xs py-4">No activity yet</p>';
            } else {
                STATE.history.slice(0, 5).forEach(item => {
                    logContainer.innerHTML += `
                    <div class="flex items-center justify-between p-3 bg-slate-800/30 rounded-lg border border-slate-700/30">
                        <span class="text-sm text-slate-300 truncate w-2/3">${item.desc}</span>
                        <span class="text-green-400 font-bold text-sm">+${item.amount}</span>
                    </div>`;
                });
            }

            // Render Tasks
            renderTasks();
            
            const pendingTasks = STATE.tasks.filter(t => t.status === 'pending').length;
            const badge = document.getElementById('task-badge');
            if (pendingTasks > 0) {
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        function renderTasks() {
            const container = document.getElementById('tasks-list');
            const featuredContainer = document.getElementById('featured-task-container');
            container.innerHTML = '';
            featuredContainer.innerHTML = '';

            // Separate tasks
            const active = STATE.tasks.filter(t => t.status === 'pending');
            const completed = STATE.tasks.filter(t => t.status === 'completed');

            // Find a featured task for Home
            if (active.length > 0) {
                const t = active[0];
                featuredContainer.innerHTML = `
                <div class="bg-slate-800 p-4 rounded-xl border border-slate-700 flex items-center justify-between cursor-pointer hover:bg-slate-750 transition-colors" onclick="openTaskModal(${t.id})">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center text-blue-400 text-xl">
                            <i class="${t.icon}"></i>
                        </div>
                        <div>
                            <p class="font-bold text-sm text-slate-200">${t.title}</p>
                            <p class="text-xs text-blue-400 font-medium">+${t.reward} Tokens</p>
                        </div>
                    </div>
                    <button class="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-bold">Start</button>
                </div>`;
            } else {
                featuredContainer.innerHTML = `
                <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700/50 text-center text-slate-500 text-xs">
                    All tasks completed! check back later.
                </div>`;
            }

            // Render Full List
            if (active.length === 0 && completed.length === 0) {
                container.innerHTML = '<p class="text-center text-slate-500 mt-10">No tasks currently available.</p>';
            }

            active.forEach(t => container.appendChild(createTaskCard(t)));
            
            if (completed.length > 0) {
                const divider = document.createElement('div');
                divider.className = "flex items-center gap-2 my-4";
                divider.innerHTML = '<div class="h-px bg-slate-700 flex-1"></div><span class="text-xs text-slate-500 font-medium tracking-wider">COMPLETED</span><div class="h-px bg-slate-700 flex-1"></div>';
                container.appendChild(divider);
                
                completed.forEach(t => container.appendChild(createTaskCard(t)));
            }
        }

        function createTaskCard(task) {
            const isCompleted = task.status === 'completed';
            const el = document.createElement('div');
            el.className = `flex items-center justify-between p-4 rounded-xl bg-slate-800 border ${isCompleted ? 'border-green-500/20 opacity-60' : 'border-slate-700'} hover:border-slate-600 transition-all`;
            
            el.innerHTML = `
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full ${isCompleted ? 'bg-green-900/20 text-green-500' : 'bg-slate-700 text-slate-300'} flex items-center justify-center text-2xl">
                        <i class="${isCompleted ? 'bi bi-check-lg' : task.icon}"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold text-sm mr-2 ${isCompleted ? 'text-slate-400 line-through' : 'text-white'}">${task.title}</h4>
                        <div class="flex items-center gap-1 mt-1">
                            <i class="bi bi-bricks text-xs ${isCompleted ? 'text-slate-500' : 'text-blue-400'}"></i>
                            <span class="text-xs font-mono font-medium ${isCompleted ? 'text-slate-500' : 'text-slate-300'}">+${task.reward}</span>
                        </div>
                    </div>
                </div>
                ${!isCompleted ? 
                    `<button onclick="openTaskModal(${task.id})" class="px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-white text-xs font-bold transition-colors">Start</button>` : 
                    `<span class="text-green-500 text-xs font-bold px-3 py-1 bg-green-500/10 rounded-lg">Done</span>`
                }
            `;
            return el;
        }

        // --- Logic: Navigation ---
        function switchTab(tabId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${tabId}-view`).classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('active', 'text-blue-400');
                el.classList.add('text-slate-500');
                if (el.dataset.target === tabId) {
                    el.classList.add('active'); // CSS handles color via .active
                    el.classList.remove('text-slate-500');
                }
            });
        }

        // --- Logic: Clicker ---
        const clickerBtn = document.getElementById('clicker-btn');
        const mainContainer = document.getElementById('main-container'); // Container relative to clicks

        clickerBtn.addEventListener('click', (e) => {
            // Vibration
            if (navigator.vibrate) navigator.vibrate(5);
            
            // Add Balance
            STATE.balance += 1;
            saveState();
            
            // Visual Updates
            document.getElementById('balance-display').textContent = STATE.balance.toLocaleString();
            document.getElementById('wallet-balance').textContent = STATE.balance.toLocaleString();

            // Floating Text
            // Calculate position relative to container to avoid offset issues
            const rect = clickerBtn.getBoundingClientRect();
            // Randomize slightly
            const randomX = (Math.random() - 0.5) * 40;
            const randomY = (Math.random() - 0.5) * 40;
            
            showFloatingText(rect.left + rect.width/2 + randomX, rect.top + rect.height/2 + randomY, "+1");
        });

        function showFloatingText(x, y, text) {
            const el = document.createElement('div');
            el.className = 'floating-text pointer-events-none fixed z-50'; // fixed to viewport
            el.textContent = text;
            el.style.left = `${x}px`;
            el.style.top = `${y}px`;
            document.body.appendChild(el); // Append to body to simplify fixed positioning
            
            setTimeout(() => el.remove(), 1000);
        }

        // --- Logic: Task Modal & Verification ---
        let currentTaskId = null;

        function openTaskModal(taskId) {
            const task = STATE.tasks.find(t => t.id === taskId);
            if (!task || task.status === 'completed') return;

            currentTaskId = taskId;
            document.getElementById('modal-title').textContent = task.title;
            document.getElementById('modal-desc').textContent = task.desc;
            document.getElementById('modal-reward').textContent = task.reward;
            
            const iconContainer = document.getElementById('modal-icon');
            iconContainer.innerHTML = `<i class="${task.icon} text-blue-400"></i>`;

            const modal = document.getElementById('task-modal');
            const backdrop = document.getElementById('modal-backdrop');
            const panel = modal.querySelector('div:nth-child(2)');

            modal.classList.remove('pointer-events-none', 'opacity-0');
            panel.classList.remove('translate-y-full'); // slide up for mobile
            
            // Reset Button states
            const checkBtn = document.getElementById('modal-check-btn');
            checkBtn.innerHTML = `Step 2: Check & Claim`;
            checkBtn.disabled = true; // Enabled after clicking link
            checkBtn.onclick = verifyTask; // Reset onclick
            
            document.getElementById('modal-action-btn').onclick = () => {
                // Determine action based on type (simulate external open)
                setTimeout(() => {
                    checkBtn.disabled = false;
                    checkBtn.classList.add('animate-pulse');
                }, 1000); // Simulate time to switch app
            };
        }

        function closeModal() {
            const modal = document.getElementById('task-modal');
            const panel = modal.querySelector('div:nth-child(2)');
            
            panel.classList.add('translate-y-full');
            setTimeout(() => {
                modal.classList.add('pointer-events-none', 'opacity-0');
                currentTaskId = null;
            }, 300);
        }

        function verifyTask() {
            const btn = document.getElementById('modal-check-btn');
            btn.innerHTML = `<div class="loader mx-auto"></div>`;
            btn.disabled = true;

            // Fake verification delay
            setTimeout(() => {
                completeTask(currentTaskId);
                closeModal();
            }, 2000);
        }

        function completeTask(id) {
            const taskIndex = STATE.tasks.findIndex(t => t.id === id);
            if (taskIndex === -1) return;

            const task = STATE.tasks[taskIndex];
            STATE.tasks[taskIndex].status = 'completed';
            STATE.balance += task.reward;
            STATE.history.unshift({ desc: `Completed: ${task.title}`, amount: task.reward });
            
            saveState();
            updateUI();
            
            showToast('Success', `You earned ${task.reward} tokens!`);
            fireConfetti();
        }

        // --- Utilities ---
        function showToast(title, message) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-title').textContent = title;
            document.getElementById('toast-message').textContent = message;
            
            toast.classList.remove('opacity-0', 'translate-y-[-20px]');
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-[-20px]');
            }, 3000);
        }

        function fireConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#3b82f6', '#06b6d4', '#ffffff']
            });
        }

        // Close modal on backdrop click
        document.getElementById('modal-backdrop').addEventListener('click', closeModal);

        // --- Init ---
        // Simulate loading state (optional) or just start
        loadState();

    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>